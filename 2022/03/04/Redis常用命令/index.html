

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/icon.png">
  <link rel="icon" href="/img/icon.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="山上的清风">
  <meta name="keywords" content="">
  
    <meta name="description" content="Redis（Remote Dictionary Server )，即远程字典服务，是一个开源的使用ANSI C语言编写、支持网络、可基于内存亦可持久化的日志型、Key-Value数据库，并提供多种语言的API。">
<meta property="og:type" content="article">
<meta property="og:title" content="Redis常用命令">
<meta property="og:url" content="http://example.com/2022/03/04/Redis%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/index.html">
<meta property="og:site_name" content="Latiy博客">
<meta property="og:description" content="Redis（Remote Dictionary Server )，即远程字典服务，是一个开源的使用ANSI C语言编写、支持网络、可基于内存亦可持久化的日志型、Key-Value数据库，并提供多种语言的API。">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://example.com/img/adorn/redis.png">
<meta property="article:published_time" content="2022-03-04T04:57:49.000Z">
<meta property="article:modified_time" content="2022-03-06T12:21:22.940Z">
<meta property="article:author" content="山上的清风">
<meta property="article:tag" content="Redis">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="http://example.com/img/adorn/redis.png">
  
  
  <title>Redis常用命令 - Latiy博客</title>

  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css" />


  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/github-markdown-css@4/github-markdown.min.css" />
  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hint.css@2/hint.min.css" />

  
    
    
      
      <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@10/styles/github-gist.min.css" />
    
  

  


<!-- 主题依赖的图标库，不要自行修改 -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_ba1fz6golrf.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />

<!-- 自定义样式保持在最底部 -->


  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    var CONFIG = {"hostname":"example.com","root":"/","version":"1.8.14","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"right","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"copy_btn":true,"image_zoom":{"enable":false,"img_url_replace":["",""]},"toc":{"enable":true,"headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"baidu":null,"google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false}},"search_path":"/local-search.xml"};
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
<meta name="generator" content="Hexo 5.4.1"></head>


<body>
  <header style="height: 70vh;">
    <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>山上的清风</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                首页
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                归档
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                分类
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                标签
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                关于
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              &nbsp;<i class="iconfont icon-search"></i>&nbsp;
            </a>
          </li>
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">&nbsp;<i
                class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

    <div class="banner" id="banner" parallax=true
         style="background: url('/img/1.jpg') no-repeat center center;
           background-size: cover;">
      <div class="full-bg-img">
        <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
          <div class="page-header text-center fade-in-up">
            <span class="h2" id="subtitle" title="Redis常用命令">
              
            </span>

            
              <div class="mt-3">
  
    <span class="post-meta mr-2">
      <i class="iconfont icon-author" aria-hidden="true"></i>
      山上的清风
    </span>
  
  
    <span class="post-meta">
      <i class="iconfont icon-date-fill" aria-hidden="true"></i>
      <time datetime="2022-03-04 12:57" pubdate>
        2022年3月4日 下午
      </time>
    </span>
  
</div>

<div class="mt-1">
  
    <span class="post-meta mr-2">
      <i class="iconfont icon-chart"></i>
      7.8k 字
    </span>
  

  
    <span class="post-meta mr-2">
      <i class="iconfont icon-clock-fill"></i>
      
      
      66 分钟
    </span>
  

  
  
    
      <!-- LeanCloud 统计文章PV -->
      <span id="leancloud-page-views-container" class="post-meta" style="display: none">
        <i class="iconfont icon-eye" aria-hidden="true"></i>
        <span id="leancloud-page-views"></span> 次
      </span>
    
  
</div>

            
          </div>

          
        </div>
      </div>
    </div>
  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="d-none d-lg-block col-lg-2"></div>
    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div class="py-5" id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">Redis常用命令</h1>
            
              <p class="note note-info">
                
                  本文最后更新于：2022年3月6日 晚上
                
              </p>
            
            <div class="markdown-body">
              <h2 id="1-全局命令"><a href="#1-全局命令" class="headerlink" title="1.全局命令"></a>1.全局命令</h2><figure class="highlight lsl"><table><tr><td class="gutter"><div class="code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></div></td><td class="code"><pre><code class="hljs lsl">获取redis配置信息：config get &lt;pattern&gt; <br>		pattern设置匹配字符串，*号表示所有<br>修改配置：config set &lt;param&gt; &lt;value&gt;<br>健总数：dbsize<br>切换数据库（index：<span class="hljs-number">0</span> ~ <span class="hljs-number">15</span>）： select index<br>设置键值<span class="hljs-type">key</span>：set <span class="hljs-type">key</span> value [EX seconds] [PX milliseconds] [NX|XX]<br>返回指定查询模式的Key：keys &lt;pattern&gt;<br>判断指定一个或多个<span class="hljs-type">key</span>是否存在：exists <span class="hljs-type">key</span> [<span class="hljs-type">key</span> ...]<br>设置指定的<span class="hljs-type">key</span>过期：expire <span class="hljs-type">key</span> seconds(秒)<br>通过设置过期时间清除缓存： expire <span class="hljs-type">key</span> seconds 或者 set <span class="hljs-type">key</span> value [EX seconds] [PX milliseconds] [NX|XX]<br>移除<span class="hljs-type">key</span>的过期时间：pexpire <span class="hljs-type">key</span> milliseconds(毫秒)<br>获取指定KEY的过期时间：ttl <span class="hljs-type">key</span>(秒) 或 pttl <span class="hljs-type">key</span>(毫秒)<br>判断指定<span class="hljs-type">key</span>的数据类型（<span class="hljs-type">string</span>,<span class="hljs-type">list</span>,hash,set,zset,...）：type <span class="hljs-type">key</span><br>删除指定的一个或多个<span class="hljs-type">key</span>：del <span class="hljs-type">key</span> [<span class="hljs-type">key</span> ...]<br>删除当前数据库所有数据：flushdb<br>删除所有数据库的数据：flushall<br>查询内部编码：object encoding <span class="hljs-type">key</span><br></code></pre></td></tr></table></figure>

<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">内部编码：<span class="hljs-keyword">object</span> <span class="hljs-keyword">encoding</span> key<br>停掉Redis服务：shutdown save<br>查询信息：<span class="hljs-keyword">info</span> memory<br></code></pre></td></tr></table></figure>



<h2 id="2-字符串string"><a href="#2-字符串string" class="headerlink" title="2.字符串string"></a>2.字符串string</h2><figure class="highlight xquery"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs xquery">设置值：set<span class="hljs-built_in"> key</span> <span class="hljs-keyword">value</span> [ex seconds] [px milliseconds] [nx|xx]<br>				ex seconds：为键设置秒级过期时间。 <br>				px milliseconds：为键设置毫秒级过期时间。 <br>				nx：键必须不存在，才可以设置成功，用于添加。 <br>				xx：与nx相反，键必须存在，才可以设置成功，用于更新。<br>键必须不存在，才可以设置成功，用于添加：setnx<span class="hljs-built_in"> key</span> <span class="hljs-keyword">value</span> <br>键必须不存在，才可以设置成功，为键设置秒级过期时间：setex<span class="hljs-built_in"> key</span> seconds <span class="hljs-keyword">value</span><br>键必须存在，才可以设置成功，用于更新：set<span class="hljs-built_in"> key</span> <span class="hljs-keyword">value</span> xx<br>获取键值：get<span class="hljs-built_in"> key</span><br>批量设置值：mset<span class="hljs-built_in"> key</span> <span class="hljs-keyword">value</span> <span class="hljs-built_in">[key</span> <span class="hljs-keyword">value</span> ...]<br>批量获取值：mget<span class="hljs-built_in"> key</span> <span class="hljs-built_in">[key</span> ...]<br>自增：incr<span class="hljs-built_in"> key</span> | incrby<span class="hljs-built_in"> key</span> long(数)<br>自减：decr<span class="hljs-built_in"> key</span> <br>自增指定数字：incrby<span class="hljs-built_in"> key</span> increment <br>自减指定数字：decrby<span class="hljs-built_in"> key</span> decrement <br>自增浮点数：incrbyfloat<span class="hljs-built_in"> key</span> increment<br><br>追加值：append<span class="hljs-built_in"> key</span> <span class="hljs-keyword">value</span><br>字符串长度：strlen<span class="hljs-built_in"> key</span><br>设置并返回原值：getset<span class="hljs-built_in"> key</span> <span class="hljs-keyword">value</span><br>设置指定位置的字符：setrange<span class="hljs-built_in"> key</span> offeset <span class="hljs-keyword">value</span><br>获取部分字符串：getrange<span class="hljs-built_in"> key</span> <span class="hljs-keyword">start</span> <span class="hljs-keyword">end</span><br></code></pre></td></tr></table></figure>



<h2 id="3-列表（按索引排序，元素可重复）list"><a href="#3-列表（按索引排序，元素可重复）list" class="headerlink" title="3.列表（按索引排序，元素可重复）list"></a>3.列表（按索引排序，元素可重复）list</h2><figure class="highlight tcl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs tcl">从左边插入元素：lpush key value [value ...] <br>从右边插入元素：rpush key value [value ...] <br>向某个元素前或者后插入元素：<span class="hljs-keyword">linsert</span> key before|<span class="hljs-keyword">after</span> pivot value<br>从左到右获取列表的所有元素：<span class="hljs-keyword">lrange</span> key <span class="hljs-number">0</span> <span class="hljs-number">-1</span><br>获取指定范围内的元素列表：<span class="hljs-keyword">lrange</span> key start stop<br>获取列表指定索引下标的元素：<span class="hljs-keyword">lindex</span> key index<br>从左端移除一个元素：lpop key<br>从右端移除一个元素：rpop key<br>删除指定元素：lrem key count value<br>按照索引范围修剪列表：ltrim key start end<br>修改指定索引下标的元素：<span class="hljs-keyword">lset</span> key index newValue<br>获取列表长度（大小）：llen key<br><br>阻塞式弹出如下：blpop key [key ...] timeout <br>		 brpop key [key ...] timeout<br>						  <br>						  <br>·lpush+lpop=Stack（栈）<br>·lpush+rpop=Queue（队列） <br>·lpsh+ltrim=Capped Collection（有限集合）<br>·lpush+brpop=Message Queue（消息队列）<br></code></pre></td></tr></table></figure>



<h2 id="4-哈希（字段名称不能重复）hash"><a href="#4-哈希（字段名称不能重复）hash" class="headerlink" title="4.哈希（字段名称不能重复）hash"></a>4.哈希（字段名称不能重复）hash</h2><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs lsl">设置单个字段值：hset <span class="hljs-type">key</span> field value<br>设置多个字段值：hmset <span class="hljs-type">key</span> field value [field value ...]<br>字段值自增：hincrby <span class="hljs-type">key</span> field increment<br>判断哈希中是否有某个字段：hexists <span class="hljs-type">key</span> field<br>删除哈希中field：hdel <span class="hljs-type">key</span> field [field ...]<br>获取某个字段值：hget <span class="hljs-type">key</span> field<br>获取多个字段值：hmget <span class="hljs-type">key</span> field [field ...]<br>获取哈希的所有内容field-value：hgetall <span class="hljs-type">key</span><br>获取哈希的所有字段名称：hkeys <span class="hljs-type">key</span><br>获取哈希的所有字段值：hvals <span class="hljs-type">key</span><br>获取哈希元素个数：hlen <span class="hljs-type">key</span><br>判断field是否存在：hexists <span class="hljs-type">key</span> field<br>计算value的字符串长度：hstrlen <span class="hljs-type">key</span> field<br></code></pre></td></tr></table></figure>



<h2 id="5-集合（元素不可重复，无效）set"><a href="#5-集合（元素不可重复，无效）set" class="headerlink" title="5.集合（元素不可重复，无效）set"></a>5.集合（元素不可重复，无效）set</h2><figure class="highlight xquery"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs xquery">添加：sadd<span class="hljs-built_in"> key</span> member [member ...]<br>返回集合中的所有元素：smembers<span class="hljs-built_in"> key</span><br>判断元素是否在集合中：sismember<span class="hljs-built_in"> key</span> member<br>随机从集合返回指定个数元素：srandmember<span class="hljs-built_in"> key</span> <span class="hljs-built_in">[count</span>]<br>删除指定的元素：srem<span class="hljs-built_in"> key</span> member [member ...]<br>从集合随机弹出元素：spop<span class="hljs-built_in"> key</span> <span class="hljs-built_in">[count</span>]<br>随机移<span class="hljs-built_in">除count</span>个元素，返回被移除的元素列表：spop<span class="hljs-built_in"> key</span><span class="hljs-built_in"> count</span><br>返回集合元素个数：scard<span class="hljs-built_in"> key</span><br><br><br>集合间操作：交集（sinter/sinterstore）、并集（sunion/sunionstore）、差集（sdiff/sdiffstore） <br>	交集，返回集合间的共同元素：sinter<span class="hljs-built_in"> key</span> <span class="hljs-built_in">[key</span> ...]<br>	交集，将交集元素存储到目标集合中：sinterstore destination<span class="hljs-built_in"> key</span> <span class="hljs-built_in">[key</span> ...]<br>	并集，返回多个集合去重后的所有元素：sunion<span class="hljs-built_in"> key</span> <span class="hljs-built_in">[key</span> ...]<br>	并集，并将并集元素存储到目标集合中：sunionstore destination<span class="hljs-built_in"> key</span> <span class="hljs-built_in">[key</span> ...]<br>	差集（A - B，结果：把A、B的共同元素从A集合中移除）：sdiff<span class="hljs-built_in"> key</span> <span class="hljs-built_in">[key</span> ...]<br>	差集：sdiffstore destination<span class="hljs-built_in"> key</span> <span class="hljs-built_in">[key</span> ...]<br>	<br>	<br>·sadd=Tagging（标签）<br>·spop/srandmember=Random <span class="hljs-type">item</span>（生成随机数，比如抽奖）<br>·sadd+sinter=Social Graph（社交需求）<br></code></pre></td></tr></table></figure>



<h2 id="6-有序集合（元素不可重复，可根据分值score进行排序）sorted-set"><a href="#6-有序集合（元素不可重复，可根据分值score进行排序）sorted-set" class="headerlink" title="6.有序集合（元素不可重复，可根据分值score进行排序）sorted set"></a>6.有序集合（元素不可重复，可根据分值score进行排序）sorted set</h2><figure class="highlight xquery"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs xquery">添加元素：zadd<span class="hljs-built_in"> key</span> [NX|XX] [CH] [INCR] score member [score member ...]<br>	·nx：member必须不存在，才可以设置成功，用于添加。 <br>	·xx：member必须存在，才可以设置成功，用于更新。<br>        ·ch：返回此次操作后，有序集合元素和分数发生变化的个数 <br>        ·incr：对score做增加，相当于后面介绍的zincrby<br> <br>计算成员个数：zcard<span class="hljs-built_in"> key</span><br>范围查询（按分值升序）：zrange<span class="hljs-built_in"> key</span> <span class="hljs-keyword">start</span> stop [withscores]<br>范围查询（按分值倒序）：zrevrange<span class="hljs-built_in"> key</span> <span class="hljs-keyword">start</span> stop [withscores]<br>返回指定分数范围的成员（升序）：zrangebyscore<span class="hljs-built_in"> key</span><span class="hljs-built_in"> min</span><span class="hljs-built_in"> max</span> [WITHSCORES] [LIMIT offset<span class="hljs-built_in"> count</span>]<br>返回指定分数范围的成员（倒序）：zrevrangebyscore<span class="hljs-built_in"> key</span><span class="hljs-built_in"> max</span><span class="hljs-built_in"> min</span> [WITHSCORES] [LIMIT offset<span class="hljs-built_in"> count</span>]										<br>注<span class="hljs-built_in">：min</span><span class="hljs-built_in">和max</span>还支持开区间（小括号）和闭区间（中括号），-inf和 +inf分别代表无限小和无限大<br>获取某个成员的分数：zscore<span class="hljs-built_in"> key</span> member<br>获取指定元素的排行（升序）：zrank<span class="hljs-built_in"> key</span> member<br>        	  （降序）：zrevrank<span class="hljs-built_in"> key</span> member<br>增加某个元素分值：zincrby<span class="hljs-built_in"> key</span> increment member (increment指定要增、减（负数）的分值)<br>删除指定排名内的升序元素：zremrangebyrank<span class="hljs-built_in"> key</span> <span class="hljs-keyword">start</span> <span class="hljs-keyword">end</span><br>删除指定的元素：zrem<span class="hljs-built_in"> key</span> member [member ...]<br>根据分值范围删除元素：zremrangebyscore<span class="hljs-built_in"> key</span><span class="hljs-built_in"> min</span><span class="hljs-built_in"> max</span><br>获取指定分值范围的元素个数：zcount<span class="hljs-built_in"> key</span><span class="hljs-built_in"> min</span><span class="hljs-built_in"> max</span><br><br><br>集合间操作：<br>	交集：zinterstore destination numkeys<span class="hljs-built_in"> key</span> <span class="hljs-built_in">[key</span> ...] [weights weight [weight ...]] [aggregate<span class="hljs-built_in"> sum</span><span class="hljs-built_in">|min</span><span class="hljs-built_in">|max</span>]<br>		·destination：交集计算结果保存到这个键<br>		·numkeys：需要做交集计算键的个数<br>		<span class="hljs-built_in">·key</span><span class="hljs-built_in">[key</span>...]：需要做交集计算的键<br>		·weights weight[weight...]：每个键的权重，在做交集计算时，每个键中的每个member会将自己分数乘以这个权重，每个键的权重默认是<span class="hljs-number">1</span><br>		·aggregate<span class="hljs-built_in"> sum</span><span class="hljs-built_in">|min</span><span class="hljs-built_in">|max</span>：计算成员交集后，分值可以按<span class="hljs-built_in">照sum</span>（和）、<span class="hljs-built_in"> min</span>（最小值）<span class="hljs-built_in">、max</span>（最大值）做汇总，默认值<span class="hljs-built_in">是sum</span><br>	并集：zunionstore destination numkeys<span class="hljs-built_in"> key</span> <span class="hljs-built_in">[key</span> ...] [weights weight [weight ...]] [aggregate<span class="hljs-built_in"> sum</span><span class="hljs-built_in">|min</span><span class="hljs-built_in">|max</span>]<br></code></pre></td></tr></table></figure>





<h2 id="7-键管理"><a href="#7-键管理" class="headerlink" title="7.键管理"></a>7.键管理</h2><figure class="highlight xquery"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs xquery">键重命名：<span class="hljs-keyword">rename</span><span class="hljs-built_in"> key</span> newkey<br>保只有newKey 不存在时候才被覆盖：renamenx<span class="hljs-built_in"> key</span> newkey<br>随机返回一个键：randomkey<br>键过期：expire<span class="hljs-built_in"> key</span> seconds：键在seconds秒后过期<br>	expireat<span class="hljs-built_in"> key</span> timestamp：键在秒级时间戳timestamp后过期<br>    注：对于字符串类型键，执行set命令会去掉过期时间，这个问题很容易 在开发中被忽视<br><br>移<span class="hljs-built_in">除key</span>的过期时间：pexpire<span class="hljs-built_in"> key</span> milliseconds(毫秒)<br>迁移键：把指定的键从源数据库移动到目标数据库：move<span class="hljs-built_in"> key</span> db<br>	dump+restore可以实现在不同的Redis实例之间进行数据迁移的功能：<br>		<span class="hljs-number">1</span>）在源Redis上，dump命令会将键值序列化，格式采用的是RDB格式：dump<span class="hljs-built_in"> key</span><br>		<span class="hljs-number">2</span>）在目标Redis上，restore命令将上面序列化的值进行复原：restore<span class="hljs-built_in"> key</span> ttl <span class="hljs-keyword">value</span><br>		<span class="hljs-number">3</span>）用于在Redis实例间进行数据迁移：migrate host port<span class="hljs-built_in"> key</span>|<span class="hljs-string">&quot;&quot;</span> destination-db timeout [<span class="hljs-keyword">copy</span>] <span class="hljs-built_in">[replace</span>] [keys<span class="hljs-built_in"> key</span> <span class="hljs-built_in">[key</span> ...]]<br><br>遍历键：<br>	全量遍历键：keys pattern<br>	渐进式遍历：scan cursor [match pattern] <span class="hljs-built_in">[count</span><span class="hljs-built_in"> number</span>]<br>		hscan、sscan、zscan渐进式地遍历hash、set、zset<br>数据库管理：<br>	切换数据库：select dbIndex<br>	清除数据库：flushdb(当前数据库)<br>	flushall命(所有数据库)<br></code></pre></td></tr></table></figure>



<h2 id="8-慢查询分析"><a href="#8-慢查询分析" class="headerlink" title="8.慢查询分析"></a>8.慢查询分析</h2><figure class="highlight excel"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs excel">获取慢查询日志：slowlog get [<span class="hljs-built_in">n</span>]<br>获取慢查询日志列表当前的长度：slowlog <span class="hljs-built_in">len</span><br>慢查询日志重置：slowlog reset	实际是对列表做清理操作<br></code></pre></td></tr></table></figure>



<h2 id="9-Redis-Shell"><a href="#9-Redis-Shell" class="headerlink" title="9.Redis Shell"></a>9.Redis Shell</h2><h3 id="1-redis-cli"><a href="#1-redis-cli" class="headerlink" title="(1)redis-cli"></a>(1)redis-cli</h3><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs jboss-cli">-r（repeat）选项代表将命令执行n次：redis-cli -r n 操作<span class="hljs-params">(比如ping)</span><br>-i（interval）选项代表每隔n秒执行一次命令，但是-i选项必须和-r选项一起使用：redis-cli -r n -i n 操作<span class="hljs-params">(比如ping)</span><br>		注意-i的单位是秒，不支持毫秒为单位，但是如果想以每隔10毫秒执行 一次，可以用-i0.01，例如：redis-cli -r 5 -i 0.01 ping<br>		利用-r和-i选项，每隔1秒输出内存的使用量：redis-cli -r n -i n info | grep used_memory_human<br>-x选项代表从标准输入（stdin）读取数据作为redis-cli的最后一个参数：<span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;键值&quot;</span> | redis-cli -x <span class="hljs-keyword">set</span> key<br>-c（cluster）选项是连接Redis Cluster节点时需要使用的，-c选项可以防 止moved和ask异常<br>如果Redis配置了密码，可以用-a（auth）选项，有了这个选项就不需要 手动输入auth命令<br><span class="hljs-params">--scan</span>选项和<span class="hljs-params">--pattern</span>选项用于扫描指定模式的键，相当于使用scan命令<br><span class="hljs-params">--slave</span>选项是把当前客户端模拟成当前Redis节点的从节点，可以用来 获取当前Redis节点的更新操作<br><span class="hljs-params">--rdb</span>选项会请求Redis实例生成并发送RDB持久化文件，保存在本地。 可使用它做持久化文件的定期备份<br><span class="hljs-params">--pipe</span>选项用于将命令封装成Redis通信协议定义的数据格式，批量发送 给Redis执行<br><span class="hljs-params">--bigkeys</span>选项使用scan命令对Redis的键进行采样，从中找到内存占用比 较大的键值，这些键可能是系统的瓶颈<br><span class="hljs-params">--eval</span>选项用于执行指定Lua脚本<br>latency有三个选项，分别是<span class="hljs-params">--latency</span>、<span class="hljs-params">--latency-history</span>、<span class="hljs-params">--latency-dist</span> 可以检测网络延迟，对于Redis的开发和运维非常有帮助<br><span class="hljs-params">--stat</span>选项可以实时获取Redis的重要统计信息，虽然info命令中的统计信 息更全，但是能实时看到一些增量的数据<br><span class="hljs-params">--no-raw</span>选项是要求命令的返回结果必须是原始的格式，<span class="hljs-params">--raw</span>恰恰相反，返回格式化后的结果<br></code></pre></td></tr></table></figure>

<h3 id="2-redis-benchmark"><a href="#2-redis-benchmark" class="headerlink" title="(2)redis-benchmark"></a>(2)redis-benchmark</h3><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs diff"><span class="hljs-deletion">-c（clients）选项代表客户端的并发数量（默认是50）</span><br><span class="hljs-deletion">-n（num）选项代表客户端请求总量（默认是100000）</span><br><span class="hljs-deletion">-q选项仅仅显示redis-benchmark的requests per second信息</span><br><span class="hljs-deletion">-P选项代表每个请求pipeline的数据量（默认为1）</span><br><span class="hljs-deletion">-k选项代表客户端是否使用keepalive，1为使用，0为不使用，默认值为 1</span><br><span class="hljs-deletion">-t选项可以对指定命令进行基准测试</span><br><span class="hljs-deletion">--csv选项会将结果按照csv格式输出，便于后续处理，如导出到Excel 等</span><br><br></code></pre></td></tr></table></figure>

<h2 id="10-事务与Lua"><a href="#10-事务与Lua" class="headerlink" title="10.事务与Lua"></a>10.事务与Lua</h2><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs mipsasm"><span class="hljs-keyword">multi命令代表事务开始，exec命令代表事务结束，它们之间的命令是原子顺序执行</span><br><span class="hljs-keyword"></span>	如果要停止事务的执行，可以使用<span class="hljs-keyword">discard命令代替exec命令即可</span><br><span class="hljs-keyword"></span>Redis如何管理Lua脚本：<br>	将Lua脚本加载到Redis内存中：<span class="hljs-keyword">script </span>load <span class="hljs-keyword">script</span><br><span class="hljs-keyword"></span>	判断<span class="hljs-keyword">sha1是否已经加载到Redis内存中：scripts </span>exists <span class="hljs-keyword">sha1 </span>[<span class="hljs-keyword">sha1 </span>…]<br>	清除Redis内存已经加载的所有Lua脚本：<span class="hljs-keyword">script </span>flush<br>	杀掉正在执行的Lua脚本：<span class="hljs-keyword">script </span>kill<br></code></pre></td></tr></table></figure>

<h2 id="11-Bitmaps"><a href="#11-Bitmaps" class="headerlink" title="11.Bitmaps"></a>11.Bitmaps</h2><figure class="highlight xquery"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs xquery">设置值：setbit<span class="hljs-built_in"> key</span> offset <span class="hljs-keyword">value</span><br>获取值：getbit<span class="hljs-built_in"> key</span> offset<br>获取Bitmaps指定范围值为<span class="hljs-number">1</span>的个数：bitcount [<span class="hljs-keyword">start</span>][<span class="hljs-keyword">end</span>]<br>Bitmaps间的运算：bitop op destkey<span class="hljs-built_in"> key</span><span class="hljs-built_in">[key</span>....]<br>		op为<span class="hljs-keyword">and</span>（交集）、<span class="hljs-keyword">or</span>（并 集）<span class="hljs-built_in">、not</span>（非）、xor（异或）操作并将结果保存在destkey<br>计算Bitmaps中第一个值为targetBit的偏移量：bitpos<span class="hljs-built_in"> key</span> targetBit [<span class="hljs-keyword">start</span>] [<span class="hljs-keyword">end</span>]<br></code></pre></td></tr></table></figure>

<h2 id="12-HyperLogLog"><a href="#12-HyperLogLog" class="headerlink" title="12.HyperLogLog"></a>12.HyperLogLog</h2><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs css">添加：pfadd key element <span class="hljs-selector-attr">[element …]</span><br>计算独立用户数：pfcount key <span class="hljs-selector-attr">[key …]</span><br>合并：pfmerge destkey sourcekey <span class="hljs-selector-attr">[sourcekey ...]</span><br><br></code></pre></td></tr></table></figure>

<h2 id="13-发布订阅"><a href="#13-发布订阅" class="headerlink" title="13.发布订阅"></a>13.发布订阅</h2><figure class="highlight inform7"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs inform7">发布消息：publish channel message<br>订阅消息：subscribe channel <span class="hljs-comment">[channel ...]</span><br>	客户端在执行订阅命令之后进入了订阅状态，只能接收subscribe、 psubscribe、unsubscribe、punsubscribe的四个命令<br>取消订阅：unsubscribe <span class="hljs-comment">[channel <span class="hljs-comment">[channel ...]</span>]</span><br>按照模式订阅和取消订阅：psubscribe pattern <span class="hljs-comment">[pattern...]</span> <br>			punsubscribe <span class="hljs-comment">[pattern <span class="hljs-comment">[pattern ...]</span>]</span><br>查询订阅：<br>	查看活跃的频道：pubsub channels <span class="hljs-comment">[pattern]</span><br>	查看频道订阅数：pubsub numsub <span class="hljs-comment">[channel ...]</span><br>	查看模式订阅数：pubsub numpat<br></code></pre></td></tr></table></figure>

<h2 id="14-GEO"><a href="#14-GEO" class="headerlink" title="14.GEO"></a>14.GEO</h2><figure class="highlight inform7"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs inform7">增加地理位置信息：geoadd key longitude latitude member <span class="hljs-comment">[longitude latitude member ...]</span><br>获取地理位置信息：geopos key member <span class="hljs-comment">[member ...]</span><br>获取两个地理位置的距离：geodist key member1 member2 <span class="hljs-comment">[unit]</span><br>			unit代表返回结果的单位，包含四种： ·m（meters）代表米<br>							  ·km（kilometers）代表公里<br>                                      			  ·mi（miles）代表英			<br>							  ·ft（feet）代表尺<br><br>获取指定位置范围内的地理信息位置集合：georadius key longitude latitude radiusm|km|ft|mi <span class="hljs-comment">[withcoord]</span> <span class="hljs-comment">[withdist]</span> <span class="hljs-comment">[withhash]</span> <span class="hljs-comment">[COUNT count]</span> <span class="hljs-comment">[asc|desc]</span> <span class="hljs-comment">[store key]</span> <span class="hljs-comment">[storedist key]</span> 												<br>				     georadiusbymember key member radiusm|km|ft|mi <span class="hljs-comment">[withcoord]</span> <span class="hljs-comment">[withdist]</span> <span class="hljs-comment">[withhash]</span> <span class="hljs-comment">[COUNT count]</span> <span class="hljs-comment">[asc|desc]</span> <span class="hljs-comment">[store key]</span> <span class="hljs-comment">[storedist key]</span><br><br>注：georadius命令 的中心位置给出了具体的经纬度，georadiusbymember只需给出成员<br>		      ·withcoord：返回结果中包含经纬度。 <br>		      ·withdist：返回结果中包含离中心节点位置的距离。<br>                      ·withhash：返回结果中包含geohash，有关geohash后面介绍。<br>                      ·COUNT count：指定返回结果的数量。<br>                      ·asc|desc：返回结果按照离中心节点的距离做升序或者降序。 <br>                      ·store key：将返回结果的地理位置信息保存到指定键。<br>                      ·storedist key：将返回结果离中心节点的距离保存到指定键。<br>获取geohash：geohash key member <span class="hljs-comment">[member ...]</span><br>删除地理位置信息：zrem key member<br></code></pre></td></tr></table></figure>



            </div>
            <hr>
            <div>
              <div class="post-metas mb-3">
                
                
                  <div class="post-meta">
                    <i class="iconfont icon-tags"></i>
                    
                      <a class="hover-with-bg" href="/tags/Redis/">Redis</a>
                    
                  </div>
                
              </div>
              
                <p class="note note-warning">
                  
                    本博客所有文章除特别声明外，均采用 <a target="_blank" href="https://creativecommons.org/licenses/by-sa/4.0/deed.zh" rel="nofollow noopener noopener">CC BY-SA 4.0 协议</a> ，转载请注明出处！
                  
                </p>
              
              
                <div class="post-prevnext">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2022/03/04/Linux%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">Linux常用命令</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2022/03/04/GitHub-Hexo%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2/">
                        <span class="hidden-mobile">GitHub+Hexo个人博客</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
              <!-- Comments -->
              <article class="comments" id="comments" lazyload>
                
                  
                
                

              </article>
            
          </article>
        </div>
      </div>
    </div>
    
      <div class="d-none d-lg-block col-lg-2 toc-container" id="toc-ctn">
        <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;目录</p>
  <div class="toc-body" id="toc-body"></div>
</div>

      </div>
    
  </div>
</div>

<!-- Custom -->

  <div class="col-lg-7 mx-auto nopadding-x-md">
    <div class="container custom post-custom mx-auto">
      <img src="https://octodex.github.com/images/jetpacktocat.png" srcset="/img/loading.gif" lazyload class="rounded mx-auto d-block mt-5" style="width:150px; height:150px;">
    </div>
  </div>


    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v"
                 for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>
    

    
  </main>

  <footer class="text-center mt-5 py-3">
  <div class="footer-content">
     <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/Latiy-125/Latiy-125.github.io" target="_blank" rel="nofollow noopener"><span>Latiy</span></a> 
  </div>
  

  

  
</footer>


  <!-- SCRIPTS -->
  
  <script  src="https://cdn.jsdelivr.net/npm/nprogress@0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/nprogress@0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js" ></script>
<script  src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>

<!-- Plugins -->


  <script  src="/js/local-search.js" ></script>



  
    <script  src="/js/img-lazyload.js" ></script>
  



  



  
    <script  src="https://cdn.jsdelivr.net/npm/tocbot@4/dist/tocbot.min.js" ></script>
  
  
  
    <script  src="https://cdn.jsdelivr.net/npm/anchor-js@4/anchor.min.js" ></script>
  
  
    <script defer src="https://cdn.jsdelivr.net/npm/clipboard@2/dist/clipboard.min.js" ></script>
  






  <script  src="https://cdn.jsdelivr.net/npm/typed.js@2/lib/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var title = document.getElementById('subtitle').title;
      
        typing(title);
      
    })(window, document);
  </script>















<!-- 主题的启动项 保持在最底部 -->
<script  src="/js/boot.js" ></script>


</body>
</html>
